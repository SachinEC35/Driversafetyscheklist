<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Safety Checklist</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        h2 { color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        .checklist-item { display: flex; align-items: center; margin-bottom: 15px; padding: 10px; border: 1px solid #eee; border-radius: 8px; cursor: pointer; }
        .checklist-item:hover { background-color: #fafafa; }
        
        input[type="checkbox"] { width: 22px; height: 22px; margin-right: 15px; cursor: pointer; }
        label { cursor: pointer; flex-grow: 1; font-weight: 500; }

        button {
            width: 100%; padding: 15px; border: none; border-radius: 8px;
            font-size: 1rem; font-weight: bold; color: white;
            background-color: #ccc; cursor: not-allowed; transition: 0.3s;
        }

        button.enabled { background-color: #28a745; cursor: pointer; }

        /* QR panel */
        .qr-panel {
            display: flex;
            gap: 12px;
            align-items: center;
            margin: 16px 0 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .qr-panel img {
            width: 140px;
            height: 140px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }
        .qr-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 150px;
        }
        .qr-actions button {
            padding: 8px 12px; font-size: 0.95rem; border-radius: 8px; border: 1px solid #ddd; background: #fff; cursor: pointer;
        }
        .qr-url {
            font-size: 0.85rem; color: #444; background: #f8f8f8; padding: 8px; border-radius: 6px; overflow-wrap: anywhere;
        }
    </style>
</head>
<body>

<div class="card">
    <h2>ðŸšœ Vehicle Safety Checklist</h2>
    
    <!-- QR Panel: scan to open this checklist -->
    <div class="qr-panel" id="qrPanel">
        <img id="qrImg" alt="QR code to open checklist">
        <div class="qr-actions">
            <div class="qr-url" id="qrUrl" title="Checklist link"></div>
            <button id="copyLinkBtn">Copy Link</button>
            <button id="openLinkBtn">Open Link</button>
            <button id="downloadQrBtn">Download QR</button>
        </div>
    </div>
    
    <div class="checklist-item">
        <input type="checkbox" id="brake" class="safety-check">
        <label for="brake">A. Brake System Check</label>
    </div>

    <div class="checklist-item">
        <input type="checkbox" id="fuel" class="safety-check">
        <label for="fuel">B. Fuel / Power Level</label>
    </div>

    <div class="checklist-item">
        <input type="checkbox" id="mirror" class="safety-check">
        <label for="mirror">C. Mirrors & Visibility</label>
    </div>

    <div class="checklist-item">
        <input type="checkbox" id="seatbelt" class="safety-check">
        <label for="seatbelt">D. Seatbelt Functionality</label>
    </div>

    <div class="checklist-item">
        <input type="checkbox" id="tyre" class="safety-check">
        <label for="tyre">E. All Wheel Tyre Condition</label>
    </div>

    <button id="confirmBtn" disabled>CONFIRM & START SHIFT</button>
</div>

<script>
    const checkboxes = document.querySelectorAll('.safety-check');
    const confirmBtn = document.getElementById('confirmBtn');

    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            // Check if every checkbox in the list is checked
            const allChecked = Array.from(checkboxes).every(c => c.checked);
            
            if (allChecked) {
                confirmBtn.disabled = false;
                confirmBtn.classList.add('enabled');
            } else {
                confirmBtn.disabled = true;
                confirmBtn.classList.remove('enabled');
            }
        });
    });

    confirmBtn.addEventListener('click', () => {
        alert("âœ… Safety Checklist Submitted. You may proceed.");
    });

    // QR panel functionality
    (function(){
        const qrImg = document.getElementById('qrImg');
        const qrUrlEl = document.getElementById('qrUrl');
        const copyBtn = document.getElementById('copyLinkBtn');
        const openBtn = document.getElementById('openLinkBtn');
        const dlBtn = document.getElementById('downloadQrBtn');

        // Build QR image URL using Google's Chart API (simple, no deps).
        function makeQrSrc(url, size = 300){
            return 'https://chart.googleapis.com/chart?cht=qr&chs=' + size + 'x' + size + '&chl=' + encodeURIComponent(url);
        }

        const pageUrl = window.location.href;
        qrUrlEl.textContent = pageUrl;
        qrImg.src = makeQrSrc(pageUrl, 300);
        qrImg.alt = 'QR for this checklist';

        copyBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(pageUrl);
                copyBtn.textContent = 'Copied!';
                setTimeout(()=>copyBtn.textContent = 'Copy Link', 1500);
            } catch (err) {
                // Fallback: select and prompt
                const ta = document.createElement('textarea'); ta.value = pageUrl; document.body.appendChild(ta); ta.select();
                try { document.execCommand('copy'); copyBtn.textContent = 'Copied!'; } catch(e){ alert('Copy failed, please copy manually:\n' + pageUrl); }
                ta.remove();
                setTimeout(()=>copyBtn.textContent = 'Copy Link', 1500);
            }
        });

        openBtn.addEventListener('click', () => {
            window.open(pageUrl, '_blank');
        });

        dlBtn.addEventListener('click', () => {
            // Download by opening the QR image URL in a new tab with download suggestion
            const src = makeQrSrc(pageUrl, 800);
            // Create an anchor and trigger download. Note: some browsers may ignore download for cross-origin URLs.
            const a = document.createElement('a');
            a.href = src;
            a.download = 'checklist-qr.png';
            document.body.appendChild(a);
            a.click();
            a.remove();
            // also open in new tab as fallback
            setTimeout(()=>window.open(src, '_blank'), 200);
        });
    })();
</script>

</body>
</html>
